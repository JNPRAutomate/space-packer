{
  "builders": [
    {
      "boot_command": [
        "admin<enter><wait5>",
        "abc123<enter><wait5>",
        "abc123<enter><wait5>",
        "{{user `space_compliant_root_password`}}<enter><wait>",
        "{{user `space_compliant_root_password`}}<enter><wait>",
        "{{user `space_compliant_root_password`}}<enter><wait>",
        "S<wait5>",
        "{{user `space_ip_address`}}<enter><wait>",
        "{{user `space_subnet_mask`}}<enter><wait>",
        "{{user `space_default_gateway`}}<enter><wait>",
        "{{user `space_dns_server`}}<enter><wait>",
        "y<enter><wait>",
        "y<enter><wait>",
        "{{user `space_mgmt_ip_eth3`}}<enter><wait>",
        "n<enter><wait>",
        "{{user `space_web_gui_ip`}}<enter><wait>",
        "n<enter><wait>",
        "{{user `space_ntp_must_be_reachable_ip`}}<enter><wait>",
        "{{user `space_cluster_maintenance_mode_pw`}}<enter><wait>",
        "{{user `space_cluster_maintenance_mode_pw`}}<enter><wait>",
        "A<enter><wait10><wait10><wait10><wait10><wait10><wait10><wait10>"
      ],
      "boot_wait": "60s",
      "http_directory": "http",
      "http_port_min": "8000",
      "http_port_max": "9000",
      "source_path": "../images/space/vmx/{{user `space_version`}}/{{user `space_version`}}.vmx",
      "output_directory": "packer-space-{{user `space_version`}}-vmware",
      "shutdown_command": "/sbin/halt -h -p",
      "ssh_password": "{{user `space_compliant_root_password`}}",
      "ssh_port": 22,
      "ssh_username": "root",
      "vnc_port_min": "5800",
      "vnc_port_max": "5900",
      "ssh_wait_timeout": "10000s",
      "type": "vmware-vmx",
      "vm_name": "packer-{{user `space_version`}}",
      "vmx_data": {
        "ide0:0.startConnected": "FALSE",
        "scsi1:0.present": "TRUE",
        "scsi1:0.deviceType": "disk",
        "scsi1:0.fileName": "{{user `space_version`}}-disk2-cl1.vmdk",
        "scsi1:0.mode": "persistent",
        "scsi1.virtualDev": "lsilogic",
        "scsi1.present": "TRUE",
        "ethernet0.connectionType": "nat",
        "ethernet1.connectionType": "nat",
        "ethernet2.connectionType": "nat",
        "ethernet3.connectionType": "nat"
      }
    }
  ],
  "post-processors": [
    {
      "output": "../builds/{{.Provider}}/space-{{user `space_version`}}-{{.Provider}}.box",
      "type": "vagrant"
    }
  ],
  "provisioners": [
    {
      "environment_vars": [
        "CHEF_VERSION={{user `chef_version`}}"
      ],
      "execute_command": "echo 'vagrant' | {{.Vars}} sudo -S -E bash '{{.Path}}'",
      "scripts": [
        "scripts/centos/fix-slow-dns.sh",
        "scripts/common/sshd.sh",
        "scripts/common/vagrant.sh",
        "scripts/common/vmtools.sh",
        "scripts/common/chef.sh",
        "scripts/centos/cleanup.sh",
        "scripts/common/minimize.sh"
      ],
      "type": "shell"
    }
  ],
  "variables": {
    "chef_version": "provisionerless",
    "space_version": "13.3R2.6",
    "space_compliant_root_password": "packer.rocks.thanks,mitchellh",
    "space_ip_address": "172.16.211.100",
    "space_subnet_mask": "255.255.255.0",
    "space_default_gateway": "172.16.211.1",
    "space_dns_server": "8.8.4.4",
    "space_mgmt_ip_eth3": "172.16.211.101",
    "space_web_gui_ip": "172.16.211.102",
    "space_ntp_must_be_reachable_ip": "17.171.4.37",

    "space_display_name": "spacebox",
    "space_cluster_maintenance_mode_pw": "skippy"
  }
}
